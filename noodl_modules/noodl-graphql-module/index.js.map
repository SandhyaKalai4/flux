{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@noodl/noodl-sdk/index.js","webpack:///./src/index.js"],"names":[],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,iBAAiB;AACjB,SAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,kBAAkB;AAC/C;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,4CAA4C,kBAAkB;AAC9D;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,kBAAkB;AACtD;AACA,kBAAkB;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;;AAEA,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,gBAAgB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA,SAAS,gBAAgB;AACzB;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA;AACA,yCAAyC,kBAAkB;AAC3D;AACA;AACA,UAAU;AACV;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,uB;;;;;;;;;;;ACvMA,cAAc,mBAAO,CAAC,kEAAkB;;AAExC;AACA,aAAa;AACb;AACA,KAAK;AACL,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;AACF;AACA;AACA;AACA,UAAU;AACV,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,UAAU,2CAA2C;AACrD;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,I;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,QAAQ;AACR,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,E","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","const _colors = {\n    \"purple\":\"component\",\n    \"green\":\"data\",\n    \"default\":\"default\",\n    \"grey\":\"default\"\n}\n\nNoodl.defineNode = function(def) {\n    const _def = {};\n\n    _def.name = def.name;\n    _def.displayNodeName = def.displayName;\n    _def.usePortAsLabel = def.useInputAsLabel;\n    _def.color = _colors[def.color || 'default'];\n    _def.category = def.category || 'Modules';\n    _def.getInspectInfo = def.getInspectInfo;\n    _def.docs = def.docs;\n    \n    _def.initialize = function() {\n        this.inputs = {};\n        var _outputs = this.outputs = {};\n        var _this = this;\n\n        // Function for quickly setting outputs\n        this.setOutputs = function(o) {\n            for(var key in o) {\n                _outputs[key] = o[key];\n                _this.flagOutputDirty(key);\n            }\n        }\n\n        // Sending warnings\n        this.clearWarnings = (function() {\n            if(this.context.editorConnection && this.nodeScope && this.nodeScope.componentOwner)\n                this.context.editorConnection.clearWarnings(this.nodeScope.componentOwner.name, this.id);\n        }).bind(this);\n\n        this.sendWarning = (function(name,message) {\n            if(this.context.editorConnection && this.nodeScope && this.nodeScope.componentOwner)\n                this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, name, {\n                    message: message\n                });\n        }).bind(this);\n\n        if(typeof def.initialize === 'function')\n            def.initialize.apply(this);\n    }\n    _def.inputs = {};\n    _def.outputs = {};\n\n    for(var key in def.inputs) {\n        _def.inputs[key] = {\n            type:(typeof def.inputs[key] === 'object')?def.inputs[key].type:def.inputs[key],\n            displayName:(typeof def.inputs[key] === 'object')?def.inputs[key].displayName:undefined,\n            group:(typeof def.inputs[key] === 'object')?def.inputs[key].group:undefined,\n            default:(typeof def.inputs[key] === 'object')?def.inputs[key].default:undefined,\n            set:(function() { const _key = key; return function(value) {\n                this.inputs[_key] = value;\n                if(def.changed && typeof def.changed[_key] === 'function') {\n                    def.changed[_key].apply(this,[value]);\n                }\n            }})()\n        }\n    }\n\n    for(var key in def.signals) {\n        _def.inputs[key] = {\n            type:'signal',\n            displayName:(typeof def.signals[key] === 'object')?def.signals[key].displayName:undefined,\n            group:(typeof def.signals[key] === 'object')?def.signals[key].group:undefined,\n            valueChangedToTrue:(function() { const _key = key; return function() {\n                const _fn = (typeof def.signals[_key] === 'object')?def.signals[_key].signal:def.signals[_key]\n                if(typeof _fn === 'function') {\n                    this.scheduleAfterInputsHaveUpdated(() => {\n                        _fn.apply(this);\n                    }) \n                }\n            }})()\n        }\n    }\n\n    for(var key in def.outputs) {\n        if(def.outputs[key] === 'signal') {\n            _def.outputs[key] = {\n                type:'signal',\n            }\n        }\n        else {\n            _def.outputs[key] = {\n                type:(typeof def.outputs[key] === 'object')?def.outputs[key].type:def.outputs[key],\n                displayName:(typeof def.outputs[key] === 'object')?def.outputs[key].displayName:undefined,\n                group:(typeof def.outputs[key] === 'object')?def.outputs[key].group:undefined,\n                getter:(function() { const _key = key; return function() {\n                    return this.outputs[_key];\n                }})()\n            }\n        }\n    }\n\n    _def.methods = _def.prototypeExtensions = {};\n    for(var key in def.methods) {\n        _def.prototypeExtensions[key] = def.methods[key];\n    }\n    if(_def.methods.onNodeDeleted) { // Override the onNodeDeleted if required\n        _def.methods._onNodeDeleted = function() {\n            this.__proto__.__proto__._onNodeDeleted.call(this);\n            _def.methods.onNodeDeleted.value.call(this);\n        }\n    }\n\n    return {node:_def,setup:def.setup};\n}\n\nNoodl.defineCollectionNode = function(def) {\n    const _def = {\n        name:def.name,\n        category:def.category,\n        color:'data',\n        inputs:def.inputs,\n        outputs:Object.assign({\n            Items:'array',\n            'Fetch Started':'signal',\n            'Fetch Completed':'signal'\n        },def.outputs||{}),\n        signals:Object.assign({\n            Fetch:function() {\n                var _this = this;\n                this.sendSignalOnOutput('Fetch Started');\n                var a = def.fetch.call(this,function() {\n                    _this.sendSignalOnOutput('Fetch Completed');\n                });\n                this.setOutputs({\n                    Items:a\n                })\n            }\n        },def.signals||{})\n    }\n\n    return Noodl.defineNode(_def);\n}\n\nNoodl.defineModelNode = function(def) {\n    const _def = {\n        name:def.name,\n        category:def.category,\n        color:'data',\n        inputs:{\n            Id:'string'\n        },\n        outputs:{\n            Fetched:'signal'\n        },\n        changed:{\n            Id:function(value) {\n                if(this._object && this._changeListener)\n                    this._object.off('change',this._changeListener)\n                \n                this._object = Noodl.Object.get(value);\n                this._changeListener = (name,value) => {\n                    const _o = {}\n                    _o[name] = value;\n                    this.setOutputs(_o)\n                }\n                this._object.on('change',this._changeListener)\n\n                this.setOutputs(this._object.data);\n                this.sendSignalOnOutput('Fetched');\n            }\n        },\n        initialize:function() {\n\n        }\n    }\n\n    for(var key in def.properties) {\n        _def.inputs[key] = def.properties[key];\n        _def.outputs[key] = def.properties[key];\n        _def.changed[key] = (function() { const _key = key; return function(value) {\n            if(!this._object) return;\n            this._object.set(_key,value);\n        }})()\n    }\n \n    return Noodl.defineNode(_def);\n}\n\nNoodl.defineReactNode = function(def) {\n    var _def = Noodl.defineNode(def);\n\n    _def.node.getReactComponent = def.getReactComponent;\n    _def.node.inputProps = def.inputProps;\n    _def.node.inputCss = def.inputCss;\n    _def.node.outputProps = def.outputProps;\n    _def.node.setup = def.setup;\n    _def.node.frame = def.frame;\n\n    return _def.node;\n}\n\nmodule.exports = Noodl;","const Noodl = require('@noodl/noodl-sdk');\n\nconst _defaultRequestHeaders = \"// Specify the request headers as a JS object, for instance:\\n\" +\n\"// headers({\\n\" +\n\"//  'Auhtorization':'secret'\\n\" +\n\"// })\\n\"+\n\"headers({})\\n\"\n\nconst GraphQLQueryNode = Noodl.defineNode({\n\tcategory: 'GraphQL',\n\tname: 'GraphQL Query',\n\tcolor: 'green',\n\tdocs: 'https://docs.noodl.net/#/modules/graphql/graphql-node',\n\tinitialize:function() {\n\t\tthis.variableValues = {};\n\t\tthis.results = {};\n\n\t\tthis.clearWarnings();\n\t},\n\tinputs: {\n\t\tQuery: {\n\t\t\tgroup:'General',\n\t\t\ttype: { name: 'string', codeeditor: 'graphql' }\n\t\t},\n\t\tEndpoint: {\n\t\t\tgroup:'General',\n\t\t\ttype: 'string'\n\t\t},\n\t\tResultsList: {\n\t\t\tgroup:'Results',\n\t\t\ttype: 'stringlist'\n\t\t},\n\t\tRequestHeaders:{\n\t\t\tgroup:'Advanced',\n\t\t\tdisplayName:'Request Headers',\n\t\t\ttype: { name: 'string', codeeditor: 'javascript' },\n\t\t\tdefault:_defaultRequestHeaders\n\t\t}\n\t},\n\toutputs: {\n\t},\n\tchanged:{\n\t\tRequestHeaders:function(value) {\n\t\t\ttry {\n\t\t\t\tthis.requestHeaderFunc = new Function('headers',value);\n\t\t\t}\n\t\t\tcatch(e) {\n\t\t\t\tthis.requestHeaderFunc = undefined;\n\t\t\t\tthis.sendWarning('grapgl-headers-warning','Error in headers script: ' +  e);\n\t\t\t}  \n\t\t}\n\t},\n\tsignals: {\n\t\tFetch: function () {\n\t\t\tthis.clearWarnings();\n\t\t\t\n\t\t\tconst xhr = new XMLHttpRequest();\n\n\t\t\txhr.onload = () => {\n\t\t\t\tif (xhr.status >= 200 && xhr.status < 300) {\n\t\t\t\t\tconst response = JSON.parse(xhr.responseText);\n\t\t\t\t\tif(response.data) {\n\t\t\t\t\t\tif(this.inputs.ResultsList) {\n\t\t\t\t\t\t\tthis.inputs.ResultsList.split(',').forEach((o) => {\n\t\t\t\t\t\t\t\tvar _o = 'res-'+o;\n\t\t\t\t\t\t\t\tif(this.hasOutput(_o)) {\n\t\t\t\t\t\t\t\t\tthis.results[o] = this.extractResult(o,response.data);\n\t\t\t\t\t\t\t\t\tthis.flagOutputDirty(_o);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if(response.errors) {\n\t\t\t\t\t\tvar message = '';\n\t\t\t\t\t\tresponse.errors.forEach((e) => message += (e.message + '\\n'))\n\t\t\t\t\t\tthis.sendWarning('grapgql-query-warning',message);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst json = {\n\t\t\t\t\"query\": this.inputs.Query,\n\t\t\t\t\"variables\": this.variableValues\n\t\t\t};\n\n\t\t\txhr.open('POST', this.inputs.Endpoint);\n\n\t\t\txhr.setRequestHeader('Content-Type', 'application/json');\n\t\t\txhr.setRequestHeader('Accept', 'application/json');\n\n\t\t\t// Let's get the user specified headers\n\t\t\tif(this.requestHeaderFunc) {\n\t\t\t\tthis.requestHeaderFunc(function(headers) {\n\t\t\t\t\tfor(var key in headers) {\n\t\t\t\t\t\txhr.setRequestHeader(key,headers[key])\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\n\t\t\txhr.send(JSON.stringify(json));\n\t\t}\n\t},\n\tmethods: {\n\t\tregisterInputIfNeeded: function (name) {\n\t\t\tif (this.hasInput(name)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.registerInput(name, {\n\t\t\t\tset: this.setVariableValue.bind(this, name.substring('var-'.length))\n\t\t\t});\n\t\t},\n\t\tregisterOutputIfNeeded: function (name) {\n\t\t\tif (this.hasOutput(name)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.registerOutput(name, {\n\t\t\t\tgetter: this.getResult.bind(this, name.substring('res-'.length))\n\t\t\t});\n\t\t},\t\t\n\t\tsetVariableValue: function (name, value) {\n\t\t\tthis.variableValues[name] = value;\n\t\t},\n\t\tgetResult: function(name) {\n\t\t\treturn this.results[name];\n\t\t},\n\t\textractResult:function(name,json) {\n\t\t\tconst result = Noodl.Array.get();\n\t\t\tresult.set(json[name]);\n\t\t\treturn result;\n\t\t}\n\t},\n\tsetup: function (context, graphModel) {\n\t\tif (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\n\t\t\treturn;\n\t\t}\n\n\t\tgraphModel.on(\"nodeAdded.GraphQL Query\", function (node) {\n\n\t\t\tfunction updatePorts() {\n\t\t\t\tvar ports = [];\n\n\t\t\t\tconst query = node.parameters.Query;\n\t\t\t\tif (query) {\n\t\t\t\t\tvar variables = query.match(/\\$[A-Za-z0-9]+/g)\n\n\t\t\t\t\tif(variables) {\n\t\t\t\t\t\tconst unique = {};\n\t\t\t\t\t\tvariables.forEach((v) => unique[v] = true)\n\n\t\t\t\t\t\tObject.keys(unique).forEach((p) => {\n\t\t\t\t\t\t\tports.push({\n\t\t\t\t\t\t\t\tname: 'var-' + p.substring(1),\n\t\t\t\t\t\t\t\tdisplayName: p.substring(1),\n\t\t\t\t\t\t\t\tgroup: 'Variables',\n\t\t\t\t\t\t\t\tplug: 'input',\n\t\t\t\t\t\t\t\ttype: { name: '*', allowConnectionsOnly: true }\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst resultsList = node.parameters.ResultsList;\n\t\t\t\tif (resultsList) {\n\t\t\t\t\tresultsList.split(',').forEach((p) => {\n\t\t\t\t\t\tports.push({\n\t\t\t\t\t\t\tname: 'res-' + p,\n\t\t\t\t\t\t\tdisplayName: p,\n\t\t\t\t\t\t\tgroup: 'Results',\n\t\t\t\t\t\t\tplug: 'output',\n\t\t\t\t\t\t\ttype: '*'\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tcontext.editorConnection.sendDynamicPorts(node.id, ports);\n\t\t\t}\n\n\t\t\tif (node.parameters.Query || node.parameters.ResultsList) {\n\t\t\t\tupdatePorts();\n\t\t\t}\n\t\t\tnode.on(\"parameterUpdated\", function (event) {\n\t\t\t\tif (event.name === \"Query\" || event.name === \"ResultsList\") {\n\t\t\t\t\tupdatePorts();\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n})\n\nNoodl.defineModule({\n\tnodes: [\n\t\tGraphQLQueryNode\n\t],\n\tsetup() {\n\t\t//this is called once on startup\n\t}\n});"],"sourceRoot":""}